!function(){"use strict";var a=function(a){var b=this;this.url=m.prop(a.url),this.plugins=m.prop(a.plugins),this.slug=m.prop(a.slug||Object.keys(a.plugins)[0]),this.n=m.prop(a.n||10),this.plugin_name=function(){for(var a=Object.keys(b.plugins()),c=0;c<a.length;c++)if(a[c]===b.slug())return b.plugins()[a[c]];return name}},b={};b.vm=function(){var b={};return b.config=new a(wpp.config),b.init=function(){b.running=m.prop(!1),b.results=m.prop([]),b.finished=m.prop(!1),b.percentageDifference=m.prop(0),b.sums=m.prop({no_plugins:0,only_slug:0,all_but_slug:0,all_plugins:0})},b}(),b.start=function(){b.vm.running(!0),b.getResult()},b.addResult=function(a){b.vm.results().push(a);var c=b.vm.sums();Object.keys(a).forEach(function(b){c[b]+=a[b]});var d=(c.only_slug/c.no_plugins+c.all_plugins/c.all_but_slug)/2*100-100;b.vm.percentageDifference(d),m.redraw()},b.getResult=function(){if(b.vm.finished(b.vm.results().length>=b.vm.config.n()),b.vm.running()&&!b.vm.finished()){var a={method:"GET",url:wpp.ajaxurl,data:{action:"plugin_profiler",url:b.vm.config.url(),slug:b.vm.config.slug()}};m.request(a).then(function(a){b.addResult(a),b.getResult()})}},b.toggle=function(){b.vm.running()?b.stop():b.start()},b.stop=function(){b.vm.running(!1)},b.reset=function(){b.vm.init()},b.controller=function(){b.vm.init()},b.view=function(){var a=b.vm;return b.vm.running()||0!==a.results().length?m("div.results",[m("p",m.trust("On average, "+a.config.plugin_name()+" added <strong>"+a.percentageDifference().toPrecision(2)+"%</strong> to each request.")),m("table",[m("tr",[m("th.row-title","#"),a.results().map(function(a,b){return m("td",b+1)}),m("th","Total")]),m("tr",[m("th.row-title","No plugins"),a.results().map(function(a){return m("td",a.no_plugins)}),m("td",a.sums().no_plugins.toPrecision(3))]),m("tr",[m("th.row-title","Only "+a.config.plugin_name()),a.results().map(function(a){return m("td",a.only_slug)}),m("td",a.sums().only_slug.toPrecision(3))]),m("tr",[m("th.row-title","All but "+a.config.plugin_name()),a.results().map(function(a){return m("td",a.all_but_slug)}),m("td",a.sums().all_but_slug.toPrecision(3))]),m("tr",[m("th.row-title","All plugins"),a.results().map(function(a){return m("td",a.all_plugins)}),m("td",a.sums().all_plugins.toPrecision(3))])]),m("p",[a.finished()?"":m("input",{type:"button","class":"button",onclick:b.toggle,value:a.running()?"Stop":"Continue"}),a.running()&&!a.finished()?"":m("input",{type:"button","class":"button button-danger",onclick:b.reset,value:"Reset"})])]):[m("table.form-table",[m("tr",[m("th","Select the plugin to profile."),m("td",[m("select",{onchange:m.withAttr("value",b.vm.config.slug)},Object.keys(b.vm.config.plugins()).map(function(c){return m("option",{value:c,selected:a.config.slug()==c},b.vm.config.plugins()[c])}))])]),m("tr",[m("th","Enter the URL to profile"),m("td",[m("input",{type:"text","class":"regular-text",value:b.vm.config.url(),onchange:m.withAttr("value",b.vm.config.url)})])]),m("tr",[m("th","Number of requests"),m("td",[m("input",{type:"number",min:0,step:1,value:b.vm.config.n(),onchange:m.withAttr("value",b.vm.config.n)})])])]),m("p",[m("input",{type:"submit","class":"button button-primary",value:"Run Profile",onclick:b.start})])]},m.module(document.getElementById("profiler-mount"),b)}();